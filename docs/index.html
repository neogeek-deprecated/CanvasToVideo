<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1">
<title>CanvasToVideo - An experiment in converting Canvas animations to video.</title>
<style>

.method h2 {
    text-overflow: ellipsis;
    overflow: hidden;
}

.permalink {
    position: absolute;
    margin-left: -25px;
    font-weight: normal;
    color: #eee;
}

.permalink:hover {
    color: #666;
    text-decoration: none;
}

.bs-footer {
    margin: 50px auto;
    color: #777;
    text-align: center;
}

pre .hljs {
    padding: 0;
    background: none;
}

</style>
<script>
(function(e,t,i){"use strict";var s=e.location.protocol==="file:"?"http:":e.location.protocol,c=["//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css","//cdn.jsdelivr.net/highlight.js/8.0/styles/github.css","//cdn.jsdelivr.net/highlight.js/8.0/highlight.min.js","//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js"];c.forEach(function(e){var o;if(e.match(/\.js$/)){o=t.createElement("script");o.setAttribute("src",s+e)}else if(e.match(/\.css$/)){o=t.createElement("link");o.setAttribute("rel","stylesheet");o.setAttribute("href",s+e)}o.addEventListener("load",function(){if(this.hasAttribute("src")){c.splice(c.indexOf(this.getAttribute("src")),1)}else if(this.hasAttribute("href")){c.splice(c.indexOf(this.getAttribute("href")),1)}if(!c.length){if($.isReady){i()}else{$(document).ready(i)}}});t.head.appendChild(o)})})(window,document,function(){var e=window.location.hash,t=$('[id="'+e.replace(/#/,"")+'"]'),i=$(".code"),s=$(".scope-private"),c=$(".toggle-code-blocks");$toggle_private=$(".toggle-private");c.on("click",function(){if(c.is(":checked")){i.show()}else{i.hide()}});$toggle_private.on("click",function(){if($toggle_private.is(":checked")){s.show()}else{s.hide()}});i.hide();s.hide();if(t.length&&!t.is(":visible")){$toggle_private.trigger("click")}$(".examples pre code, .code pre code").each(function(){hljs.highlightBlock(this)})});
</script>
</head>

<body>

<div class="wrap">

    <div class="container">

        <div class="page-header">

            <div class="pull-right hidden-sm hidden-xs">

                <div>
                    <label>
                        <input type="checkbox" name="toggle-code" class="toggle-code-blocks">
                        Toggle Code Blocks
                    </label>
                </div>
                <div>
                    <label>
                        <input type="checkbox" name="toggle-private" class="toggle-private">
                        Toggle Private Methods
                    </label>
                </div>

            </div>

            <h1>CanvasToVideo <small>An experiment in converting Canvas animations to video.</small></h1>

        </div>

        <div class="row">

            <div class="col-md-3 hidden-sm hidden-xs">

                <ul class="nav">

                    

                        

                    

                        

                            

                                <li class="scope-private">
                                    <a href="#putrequest">putRequest()</a>
                                </li>

                            

                        

                    

                        

                            

                                <li class="scope-public">
                                    <a href="#canvastovideo">CanvasToVideo()</a>
                                </li>

                            

                        

                    

                        

                            

                                <li class="scope-public">
                                    <a href="#canvastovideo.prototype.capture">CanvasToVideo.capture()</a>
                                </li>

                            

                        

                    

                        

                            

                                <li class="scope-public">
                                    <a href="#canvastovideo.prototype.flush">CanvasToVideo.flush()</a>
                                </li>

                            

                        

                    

                        

                            

                                <li class="scope-public">
                                    <a href="#canvastovideo.prototype.setcanvas">CanvasToVideo.setCanvas()</a>
                                </li>

                            

                        

                    

                        

                            

                                <li class="scope-public">
                                    <a href="#canvastovideo.prototype.setcacheenabled">CanvasToVideo.setCacheEnabled()</a>
                                </li>

                            

                        

                    

                        

                            

                                <li class="scope-public">
                                    <a href="#canvastovideo.prototype.setendpoint">CanvasToVideo.setEndpoint()</a>
                                </li>

                            

                        

                    

                        

                            

                                <li class="scope-public">
                                    <a href="#canvastovideo.prototype.setimagetype">CanvasToVideo.setImageType()</a>
                                </li>

                            

                        

                    

                        

                            

                                <li class="scope-public">
                                    <a href="#canvastovideo.prototype.setimagequality">CanvasToVideo.setImageQuality()</a>
                                </li>

                            

                        

                    

                        

                    

                </ul>

            </div>

            <div class="col-md-9">

                

                    

                

                    

                        

                            <div class="method scope-private">

                                

                                <h2 id="putrequest">
                                    <a href="#putrequest" class="permalink">#</a> putRequest()
                                    
                                    <small>private method</small>
                                    
                                </h2>

                                <p>Sends a PUT request to a URL with the specified data and fires a callback upon completion.</p>

                                
                                
                                
                                
                                
                                
                                

                                

                                <section class="parameters">

                                    <h3>Parameters</h3>

                                    

                                        

                                            <p>
                                                <b>url</b>
                                                
                                                    <code>String</code>
                                                
                                                
                                            </p>
                                            <p>The URL for the PUT request.</p>

                                        

                                    

                                        

                                            <p>
                                                <b>data</b>
                                                
                                                    <code>Object</code>
                                                
                                                
                                            </p>
                                            <p>The data to send.</p>

                                        

                                    

                                        

                                            <p>
                                                <b>callback</b>
                                                
                                                    <code>Function</code>
                                                
                                                
                                                    <span class="label label-default">Optional</span>
                                                
                                            </p>
                                            <p>The callback function to call once the request has completed.</p>

                                        

                                    

                                        

                                    

                                        

                                    

                                </section>

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>putRequest(&#39;capture.php&#39;, [], function() { alert(&#39;Done!&#39;); });
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>function putRequest(url, data, callback) {

        var http = new window.XMLHttpRequest();

        http.open(&#x27;put&#x27;, url);

        if (Object.prototype.toString.call(data) === &#x27;[object Array]&#x27;) {

            data = JSON.stringify(data);

        }

        if (String(typeof callback) === &#x27;function&#x27;) {

            http.addEventListener(&#x27;readystatechange&#x27;, function () {

                if (this.readyState === 4 &amp;&amp; this.status === 204) {

                    callback.call(this);

                }

            });

        }

        http.send(data);

    }</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                

                                    

                                

                                    

                                

                                    

                                        <p><code>void</code>  </p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                        

                            <div class="method scope-public">

                                

                                <h2 id="canvastovideo">
                                    <a href="#canvastovideo" class="permalink">#</a> CanvasToVideo()
                                    
                                </h2>

                                <p>Creates a new CanvasToVideo object.</p>

                                
                                
                                
                                
                                

                                

                                <section class="parameters">

                                    <h3>Parameters</h3>

                                    

                                        

                                            <p>
                                                <b>url</b>
                                                
                                                    <code>String</code>
                                                
                                                
                                            </p>
                                            <p>The URL for all PUT requests.</p>

                                        

                                    

                                        

                                            <p>
                                                <b>canvas</b>
                                                
                                                    <code>Object</code>
                                                
                                                
                                            </p>
                                            <p>The canvas to capture frames from.</p>

                                        

                                    

                                        

                                    

                                        

                                    

                                </section>

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>var ctv = new CanvasToVideo(&#39;capture.php&#39;, document.querySelector(&#39;canvas&#39;));
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>var CanvasToVideo = function (url, canvas) {

        this.url = url;
        this.canvas = canvas;

        this.imageType = &#x27;image/png&#x27;;
        this.imageQuality = 100;

        this.cache = [];
        this.cacheEnabled = false;

        try {

            this.canvas.getContext(&#x27;2d&#x27;);

        } catch (e) {

            this.canvas = null;

            throw new Error(&#x27;Element passed to CanvasToVideo was not a valid canvas element.&#x27;);

        }

    };</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                

                                    

                                

                                    

                                        <p><code>Object</code>  New CanvasToVideo object.</p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                        

                            <div class="method scope-public">

                                

                                <h2 id="canvastovideo.prototype.capture">
                                    <a href="#canvastovideo.prototype.capture" class="permalink">#</a> CanvasToVideo.capture()
                                    
                                </h2>

                                <p>Method called after canvas drawing has occured to capture frame and either send to server or store in local temporary cache.</p>

                                

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>function draw () {
    // draw objects to canvas
    ctv.capture();
    requestAnimationFrame(draw);
}
requestAnimationFrame(draw);
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>CanvasToVideo.prototype.capture  = function () {

        var data;

        if (this.canvas) {

            data = this.canvas.toDataURL(this.imageType, this.imageQuality).replace(/^[\W\w]*,/, &#x27;&#x27;);

            if (this.cacheEnabled) {

                this.cache.push(data);

            } else {

                putRequest(this.url, [data]);

            }

        }

    };</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                        <p><code>void</code>  </p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                        

                            <div class="method scope-public">

                                

                                <h2 id="canvastovideo.prototype.flush">
                                    <a href="#canvastovideo.prototype.flush" class="permalink">#</a> CanvasToVideo.flush()
                                    
                                </h2>

                                <p>Called once animation is complete to send all cached images to the server through the specified URL.</p>

                                

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>ctv.flush();
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>CanvasToVideo.prototype.flush  = function () {

        if (this.cacheEnabled) {

            putRequest(this.url, this.cache, function () {

                this.cache = [];

            });

        }

    };</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                        <p><code>void</code>  </p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                        

                            <div class="method scope-public">

                                

                                <h2 id="canvastovideo.prototype.setcanvas">
                                    <a href="#canvastovideo.prototype.setcanvas" class="permalink">#</a> CanvasToVideo.setCanvas()
                                    
                                </h2>

                                <p>Sets a new canvas tag once the CanvasToVideo object has already been created.</p>

                                
                                
                                

                                

                                <section class="parameters">

                                    <h3>Parameters</h3>

                                    

                                        

                                            <p>
                                                <b>canvas</b>
                                                
                                                    <code>Object</code>
                                                
                                                
                                            </p>
                                            <p>The canvas to capture frames from.</p>

                                        

                                    

                                        

                                    

                                        

                                    

                                </section>

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>ctv.setCanvas(document.querySelector(&#39;.stage&#39;));
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>CanvasToVideo.prototype.setCanvas = function (canvas) {

        this.canvas = canvas;

        try {

            this.canvas.getContext(&#x27;2d&#x27;);

        } catch (e) {

            this.canvas = null;

            throw new Error(&#x27;Element passed to CanvasToVideo.setCanvas was not a valid canvas element.&#x27;);

        }

    };</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                

                                    

                                        <p><code>void</code>  </p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                        

                            <div class="method scope-public">

                                

                                <h2 id="canvastovideo.prototype.setcacheenabled">
                                    <a href="#canvastovideo.prototype.setcacheenabled" class="permalink">#</a> CanvasToVideo.setCacheEnabled()
                                    
                                </h2>

                                <p>Sets if caching is enabled or not.</p>

                                
                                
                                

                                

                                <section class="parameters">

                                    <h3>Parameters</h3>

                                    

                                        

                                            <p>
                                                <b>enabled</b>
                                                
                                                    <code>Boolean</code>
                                                
                                                
                                            </p>
                                            <p>Boolean flag for enabling cache.</p>

                                        

                                    

                                        

                                    

                                        

                                    

                                </section>

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>ctv.setCacheEnabled(true); // Caching enabled.
ctv.setCacheEnabled(false); // Caching disabled.
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>CanvasToVideo.prototype.setCacheEnabled = function (enabled) {

        if (enabled) {

            this.cacheEnabled = true;

        } else {

            this.cacheEnabled = false;

        }

    };</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                

                                    

                                        <p><code>void</code>  </p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                        

                            <div class="method scope-public">

                                

                                <h2 id="canvastovideo.prototype.setendpoint">
                                    <a href="#canvastovideo.prototype.setendpoint" class="permalink">#</a> CanvasToVideo.setEndpoint()
                                    
                                </h2>

                                <p>Sets a new URL for sending all PUT requests.</p>

                                
                                
                                

                                

                                <section class="parameters">

                                    <h3>Parameters</h3>

                                    

                                        

                                            <p>
                                                <b>url</b>
                                                
                                                    <code>String</code>
                                                
                                                
                                            </p>
                                            <p>The new URL for all PUT requests.</p>

                                        

                                    

                                        

                                    

                                        

                                    

                                </section>

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>ctv.setEndpoint(&#39;different_capture_url.php&#39;);
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>CanvasToVideo.prototype.setEndpoint  = function (url) {

        this.url = url;

    };</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                

                                    

                                        <p><code>void</code>  </p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                        

                            <div class="method scope-public">

                                

                                <h2 id="canvastovideo.prototype.setimagetype">
                                    <a href="#canvastovideo.prototype.setimagetype" class="permalink">#</a> CanvasToVideo.setImageType()
                                    
                                </h2>

                                <p>Sets the image type saved from the canvas. Can be either image/png or image/jpeg.</p>

                                
                                
                                

                                

                                <section class="parameters">

                                    <h3>Parameters</h3>

                                    

                                        

                                            <p>
                                                <b>type</b>
                                                
                                                    <code>String</code>
                                                
                                                
                                            </p>
                                            <p>The type of image to be captured from the canvas.</p>

                                        

                                    

                                        

                                    

                                        

                                    

                                </section>

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>ctv.setImageType(&#39;image/png&#39;);
ctv.setImageType(&#39;image/jpeg&#39;);
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>CanvasToVideo.prototype.setImageType  = function (type) {

        if (type.match(/image\/(png|jpeg)/)) {

            this.imageType = type;

        } else {

            throw new Error(type + &#x27; is not a valid image type. The valid types are: image/png and image/jpeg.&#x27;);

        }

    };</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                

                                    

                                        <p><code>void</code>  </p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                        

                            <div class="method scope-public">

                                

                                <h2 id="canvastovideo.prototype.setimagequality">
                                    <a href="#canvastovideo.prototype.setimagequality" class="permalink">#</a> CanvasToVideo.setImageQuality()
                                    
                                </h2>

                                <p>Sets the image quality saved from the canvas. Must be an integer between 0 and 100.</p>

                                
                                
                                

                                

                                <section class="parameters">

                                    <h3>Parameters</h3>

                                    

                                        

                                            <p>
                                                <b>type</b>
                                                
                                                    <code>Integer</code>
                                                
                                                
                                            </p>
                                            <p>Number between 0 and 100 specifying the quality.</p>

                                        

                                    

                                        

                                    

                                        

                                    

                                </section>

                                

                                

                                

                                <section class="examples">

                                    <h3>Examples</h3>

                                    <pre><code>ctv.setImageQuality(60);
</code></pre>

                                </section>

                                <section class="code">

                                    <h3>Code</h3>

                                    <pre><code>CanvasToVideo.prototype.setImageQuality  = function (quality) {

        if (String(typeof quality) === &#x27;number&#x27;) {

            this.imageQuality = quality;

        } else {

            throw new Error(quality + &#x27; is not a valid number. Must be a number between 0 (lowest quality) and 100 (highest quality).&#x27;);

        }

    };</code></pre>

                                </section>

                                <h3>Returns</h3>

                                

                                    

                                

                                    

                                        <p><code>void</code>  </p>

                                    

                                

                                    

                                

                            </div>

                        

                    

                

                    

                

            </div>

        </div>

    </div>

</div>

<footer class="bs-footer">

    <div class="container">

        <p>Documentation generated with <a href="https://github.com/neogeek/doxdox">doxdox</a>.</p>

    </div>

</footer>

</body>
</html>
